# C Tools MCP: AI-Assisted C Code Compilation & Disassembly

## Overview

This project explores the integration of AI and the Model Context Protocol (MCP) to automate the compilation, disassembly, and analysis of C source code. The system leverages AI to assist in reverse engineering, vulnerability detection, and code understanding by providing tools and resources for compiling C code, generating disassembly, and reviewing code for security issues.

## Features

- **Automated Compilation & Disassembly:** Compile C source files using GCC and disassemble binaries with `objdump`.
- **AI-Powered Code Review:** Use AI to analyze C code and its disassembly for vulnerabilities, memory issues, and security flaws.
- **Batch Processing:** Scripts to collect, compile, and disassemble C files from multiple repositories.
- **Data Resources:** Pre-collected examples of C code and their disassemblies for AI training and context priming.
- **JSON Output & Fixing:** Automated output of results in JSON format, with tools to ensure valid JSON structure.

## Project Structure

``` txt
infosec/
│
├── c_tools_mcp.py           # Newer MCP server: main entry for AI tools (compile, disassemble, review)
├── MCP_server.py            # Older MCP server version (legacy, similar functionality)
├── script                   # Bash script: clones repos, compiles/disassembles all .c files, outputs to output.json
├── json_fix                 # Bash script: fixes output.json formatting issues
├── output.json              # Main output: stores code/disassembly pairs (large file, generated by script)
├── context_samples/
│   ├── samples.json         # Example C code and disassembly pairs for AI context/training
│   └── output.json          # (Large) Additional code/disassembly data for context
├── example_files/
│   ├── ex1.c                # Simple C example for testing
│   ├── ex_server.c          # Example TCP server in C
│   └── ex_client.c          # Example TCP client in C
├── todo.txt                 # Project notes and future ideas
└── README.md                # Project documentation (this file)
```

## Getting Started

### Prerequisites

- Python 3.x
- GCC (for compiling C code)
- objdump (for disassembly)
- Bash shell (for running scripts)
- jq (for JSON processing in scripts)
- Git (for cloning repositories)

### Installation

1. **Clone the repository:**

   ```sh
   git clone <your-repo-url>
   cd infosec
   ```

2. **Install required Python packages:**
   (Add requirements.txt if needed, e.g., for MCP server dependencies.)

3. **Ensure GCC, objdump, jq, and git are installed and available in your PATH.**

## License

[Specify your license here, e.g., MIT, GPL, etc.]

---

# Usage Instructions

## Quick Start

1. **Clone the repository:**

   ```sh
   git clone <your-repo-url>
   cd infosec
   ```

2. **Install Python dependencies:**

   ```sh
   pip install -r requirements.txt
   ```

   - This project requires `pydantic` (see requirements.txt).
   - **Note:** The MCP server framework (`mcp.server.fastmcp`) is required but not available on PyPI. You must obtain it from your instructor or project lead, or ensure it is available in your Python environment.

3. **Install system dependencies:**
   - **GCC** (for compiling C code)
   - **objdump** (for disassembly)
   - **jq** (for JSON processing in scripts)
   - **git** (for cloning repositories)
   - **bash** (for running scripts)

   On Ubuntu/Debian:

   ```sh
   sudo apt update
   sudo apt install build-essential binutils jq git bash
   ```

   On Windows, use WSL or install MinGW for GCC/objdump, and ensure all tools are in your PATH.

4. **Run the MCP server:**
   - **New version:**

     ```sh
     python c_tools_mcp.py
     ```

   - **Legacy version:**

     ```sh
     python MCP_server.py
     ```

5. **Batch compile & disassemble C files:**

   ```sh
   bash script
   ```

   - This will clone public C repositories, compile all `.c` files, and generate `output.json` with code/disassembly pairs.
   - If `output.json` is malformed, fix it with:

     ```sh
     bash json_fix
     ```

6. **Test with example files:**
   - Use files in `example_files/` (e.g., `ex1.c`, `ex_server.c`, `ex_client.c`) to test the server and tools.

---

# Setup Guide for MCP Server

## 1. Python Environment

- Use Python 3.10 or newer for best compatibility.
- (Optional but recommended) Create a virtual environment:

  ```sh
  python -m venv venv
  source venv/bin/activate  # On Windows: venv\Scripts\activate
  ```

## 2. Install Required Packages

- Install Python dependencies:

  ```sh
  pip install -r requirements.txt
  ```

- **MCP Server Framework:**
  - The `mcp.server.fastmcp` module is not available on PyPI. You must:
    - Obtain it from your instructor, project lead, or course resources.
    - Place it in your Python path or install as a local package if provided.
    - If you have a `mcp/` directory, ensure it is in the same directory as your scripts or in your PYTHONPATH.

## 3. System Dependencies

- **GCC** and **objdump**: Required for compiling and disassembling C code.
- **jq**: Used by scripts for JSON processing.
- **git**: Used for cloning repositories.
- **bash**: Required for running provided scripts.

## 4. Running the MCP Server

- To start the new MCP server:

  ```sh
  python c_tools_mcp.py
  ```

- To start the legacy server:

  ```sh
  python MCP_server.py
  ```

- The server exposes tools for compiling, disassembling, and reviewing C code. You can interact with it via the provided scripts or by extending the server with your own tools.

## 5. Example Commands

- **Compile and disassemble a C file manually:**

  ```sh
  python c_tools_mcp.py  # (or python MCP_server.py)
  # Follow prompts or use the API as described in the code.
  ```

- **Batch process C files:**

  ```sh
  bash script
  bash json_fix  # If needed
  ```

## 6. Troubleshooting

- If you see `ModuleNotFoundError: No module named 'mcp'`, ensure the MCP server framework is available in your Python environment.
- For issues with GCC or objdump, check your system PATH and installation.
- For malformed JSON, use the `json_fix` script.

---

For more details, see the comments in `c_tools_mcp.py` and `MCP_server.py`, or contact your instructor/project lead for support.
